## Proxy Structure
The file structure of he proxy folder is as follows:

```
    ├── service			# proxy tunneling and data capturing
    ├── service/local_storage	# local storage of tls and record layer transcript data
    ├── verifier		# zk snark verification logic
    ├── verifier/tls_helper	# tls data parser and post processing logic
```
We outline more details on proxy sub-folders in the sections below.

### service
The service folder contains the proxy implementation which is a tcp tunneling service which forwards incoming http/tcp messages to the respective destination. The service allows to start, stop, and check availability of the proxy server. The tunneling service stores captured transcripts in another `local_storage` folder. The service runs as a compiled module, such that is can be started as a background process. The `pid.json` file is supposed to track the service after a _ORIGO_ command starts the service in the background.

### service/local\_storage
Local storage folder of proxy which stores captured tls handshake and record layer transcripts in form of server sent records and prover sent records. Additionally after receiving additional public input parameters of the prover, the proxy stores public input in an extra JSON file called `PublicInput.json`. The proxy makes use of public input parameters to verify the ZKP generated by provers.

#### About Public Input JSON
The proxy post processes the above-revealed data, parses all the TLS records, and then saves the output as the public statement. Those parameters are generated automatically by the prover as well. The prover also has these parameters but calculated by itself before revealing the above-shared data. Additional introduced elements obtained by the proxy are listed below:

- *CiphertextToProof*: the ciphertext of the relevant plaintext for proof
- *HkdfSHTSInnerHash*: the inner hash of the total block of the HKDF SHTS
- *HkdfKFSInnerHash*: the inner hash of the total block of the HKDF KFS
- *HkdfSFInnerHash*: the inner hash of the total block of the HKDF SF
- *HkdfDHSInnerHash*: the inner hash of the total block of the HKDF dHS
- *HkdfMSInnerHash*: the inner hash of the total block of the HKDF MS
- *HkdfSATSInnerHash*: the inner hash of the total block of the HKDF SATS
- *HkdfCATSInnerHash*: the inner hash of the total block of the HKDF CATS
- *HkdfKSAPPKeyInnerHash*: the inner hash of the total block of the HKDF KSAPP key
- *HkdfKSAPPIVInnerHash*: the inner hash of the total block of the HKDF KSAPP IV
- *HkdfKCAPPKeyInnerHash*: the inner hash of the total block of the HKDF KCAPP key
- *HkdfKCAPPIVInnerHash*: the inner hash of the total block of the HKDF KCAPP IV

### verifier
The verifier folder contains the logic to compute public input data required for verifying zero-knowledge proofs and proof verification logic. We separated this part from the proxy tunneling and transcript capturing part in order to have the flexibility in changing the verification snark system.

### verifier/tls\_helper
The folder is supposed to store all necessary functions required to parse server and prover sent records into public input parameters. Currently, this folder does not exist but this package serves to resolve the current dependency issue that the proxy depends on the modified TLS folder which resides in the prover folder. We plan to separate the proxy folder such that it can be cloned and executed on a machine which does not download any prover specific code.

### Remaining Todos
- implement communication endpoint to handle shared policy extract JSON data from prover
- get rid of `prover/tls` dependent functions which currently reside in the prover folder and move these files to a `proxy/verifier/tls_helper` folder.

